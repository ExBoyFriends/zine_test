<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Carousel + Siren Sequence</title>

<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  overflow:hidden;
  /*background:#000;*/
}

/* ===== 背景 ===== */
.background-normal{
  position:fixed;
  inset:0;
  background:url("image/background.jpg") center/cover no-repeat;
  z-index:-3;
  opacity:1;
}

.background-siren{
  position:fixed;
  inset:0;
  background:url("image/background.jpg") center/cover no-repeat;
  z-index:-2;
  opacity:1;
  animation:sirenBlink 1.6s ease-in-out infinite;
}

/* 暗くなるだけ */
@keyframes sirenBlink{
  0%   { opacity:1; }
  50%  { opacity:0.2; }
  100% { opacity:1; }
}

/* ===== カルーセル ===== */
.carousel-wrapper{
  position:relative;
  width:100%;
  height:100%;
}

.carousel-page{
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  gap:10px;
  opacity:0;
  pointer-events:none;
  transition:opacity 3.85s ease;
}

.carousel-page.active{
  opacity:1;
  pointer-events:auto;
}

/* 初回だけ深い */
.carousel-page.first-load{
  transition:opacity 5.6s ease;
}

.carousel-inner img{
  width:80vw;
  max-width:480px;
  border-radius:8px;
}

/* ===== ドット ===== */
.dots{
  position:absolute;
  bottom:20px;
  width:100%;
  text-align:center;
  opacity:0;
  transition:opacity 17.7s ease;
}

.dots.visible{ opacity:1; }

.dot{
  display:inline-block;
  width:10px;
  height:10px;
  background:#555;
  margin:0 6px;
}

.dot.active{ background:#fff; }
</style>
</head>

<body>

<!-- 背景 -->
<div class="background-normal"></div>
<div class="background-siren"></div>

<div class="carousel-wrapper">

  <div class="carousel-page active first-load">
    <div class="carousel-inner">
      <img src="image/queen.of.clubs.png">
      <img src="image/queen.of.clubs_mirror.png">
    </div>
  </div>

  <div class="carousel-page">
    <div class="carousel-inner">
      <img src="image/king.of.spades.png">
      <img src="image/king.of.spades_mirror.png">
    </div>
  </div>

  <div class="carousel-page">
    <div class="carousel-inner">
      <img src="image/jack.of.hearts.png">
      <img src="image/jack.of.hearts_mirror.png">
    </div>
  </div>

  <div class="carousel-page">
    <div class="carousel-inner">
      <img src="image/joker_a.png">
      <img src="image/joker_b.png">
    </div>
  </div>

  <div class="carousel-page">
    <div class="carousel-inner">
      <img src="image/zebra.png">
    </div>
  </div>

  <div class="dots">
    <span class="dot active"></span>
    <span class="dot"></span>
    <span class="dot"></span>
    <span class="dot"></span>
    <span class="dot"></span>
  </div>

</div>

<script>
const pages = document.querySelectorAll(".carousel-page");
const dots = document.querySelectorAll(".dot");
const dotsContainer = document.querySelector(".dots");
const sirenBg = document.querySelector(".background-siren");

let currentPage = 0;
let isAnimating = true;

/* 初期：全部消す */
pages.forEach((p,i)=>{
  p.style.opacity = i===0 ? 0 : 0;
});

/* ===== 演出シーケンス ===== */
window.onload = () => {

  // 1. サイレンを 4 秒流す
  setTimeout(()=>{
    // 2. サイレンをフェードアウト（暗黒へ）
    sirenBg.style.transition = "opacity 1.5s ease";
    sirenBg.style.opacity = 0;

    // 3. カルーセル初回フェード開始
    pages[0].classList.add("active");
    pages[0].style.opacity = 1;

    // 4. 初回フェード完了
    setTimeout(()=>{
      pages[0].classList.remove("first-load");
      isAnimating = false;

      // 5. ドット表示
      dotsContainer.classList.add("visible");

    },5600);

  },4000);
};

/* 確認用：クリックでページ送り */
document.body.addEventListener("click",()=>{
  if(isAnimating) return;
  const next = (currentPage+1)%pages.length;
  changePage(next);
});

function changePage(next){
  isAnimating = true;

  pages[currentPage].classList.remove("active");
  pages[next].classList.add("active");

  setTimeout(()=>{
    currentPage = next;
    dots.forEach((d,i)=>d.classList.toggle("active",i===currentPage));
    isAnimating = false;
  },3850);
}
</script>

</body>
</html>