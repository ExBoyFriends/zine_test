<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0">
<title>Digital ZINE Demo</title>
<style>
body {
margin: 0;
background: #111;
overflow: hidden;
touch-action: none;
}

#zine {
position: relative;
width: 100vw;
height: 100vh;
}

.page {
position: absolute;
top: 0;
bottom: 0;
width: 50%;
overflow: hidden;
display: flex;
justify-content: center;
align-items: center;
}

.page img {
max-height: 100%;
user-select: none;
-webkit-user-drag: none;
}

#left {
left: 0;
}

#right {
right: 0;
}

/* 縦向き：左ページだけ表示 */
.portrait #right {
display: none;
}

.portrait #left {
width: 100%;
}

/* 見開き1枚絵用 */
.spread-image {
cursor: grab;
}
</style>
</head>
<body>

<div id="zine">
<div id="left" class="page">
<img id="leftImg" src="">
</div>
<div id="right" class="page">
<img id="rightImg" src="">
</div>
</div>

<script>
/*
ページデータ
spread:true のページは「見開き1枚絵」
left と right に同じ画像を入れる
*/
const pages = [
{ left: "https://picsum.photos/800/1200?1", right: "https://picsum.photos/800/1200?2", spread:false },
{ left: "https://picsum.photos/1600/1200?3", right: "https://picsum.photos/1600/1200?3", spread:true },
{ left: "https://picsum.photos/800/1200?4", right: "https://picsum.photos/800/1200?5", spread:false }
];

let index = 0;
let startX = 0;
let currentX = 0;
let dragging = false;

const zine = document.getElementById("zine");
const leftImg = document.getElementById("leftImg");
const rightImg = document.getElementById("rightImg");

function isPortrait() {
return window.innerHeight > window.innerWidth;
}

function render() {
const page = pages[index];
leftImg.src = page.left;
rightImg.src = page.right;

if (isPortrait()) {
document.body.classList.add("portrait");
} else {
document.body.classList.remove("portrait");
leftImg.style.transform = "";
}
}

window.addEventListener("resize", render);
render();

/* タッチ操作 */
zine.addEventListener("touchstart", e => {
startX = e.touches[0].clientX;
currentX = startX;
dragging = true;
});

zine.addEventListener("touchmove", e => {
if (!dragging) return;

const dx = e.touches[0].clientX - startX;
const page = pages[index];

// 縦向き + 見開き1枚絵 → 画像ドラッグ
if (isPortrait() && page.spread) {
leftImg.style.transform = `translateX(${dx}px)`;
}
});

zine.addEventListener("touchend", e => {
dragging = false;
const dx = currentX - startX;
const page = pages[index];

// 縦向き + 見開き1枚絵 → ページ送りしない
if (isPortrait() && page.spread) {
leftImg.style.transition = "transform 0.3s";
leftImg.style.transform = "translateX(0)";
setTimeout(() => leftImg.style.transition = "", 300);
return;
}

// 通常ページめくり
if (dx < -50 && index < pages.length - 1) {
index++;
} else if (dx > 50 && index > 0) {
index--;
}

render();
});
</script>

</body>
</html>
