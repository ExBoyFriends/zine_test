<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Carousel + Siren Background</title>

<style>
html, body {
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  overflow:hidden;
  -webkit-user-select:none;
  user-select:none;
}

/* ===============================
   背景レイヤー
   =============================== */

/* 通常背景（基準の明るさ） */
.background-normal {
  position: fixed;
  inset: 0;
  background: url("image/background.jpg") center/cover no-repeat;
  z-index: -3;
}

/* サイレン用背景（暗くなるだけ） */
.background-siren {
  position: fixed;
  inset: 0;
  background: url("image/background.jpg") center/cover no-repeat;
  z-index: -2;
  filter: brightness(1);
  opacity: 1;
  animation: sirenBlink 1.6s ease-in-out infinite;
}

/* 暗くなるだけのサイレン */
@keyframes sirenBlink {
  0%   { filter: brightness(1); }
  50%  { filter: brightness(0.3); }
  100% { filter: brightness(1); }
}


/* ===============================
   カルーセル
   =============================== */

.carousel-wrapper {
  position: relative;
  width:100vw;
  height:100vh;
  overflow:hidden;
  z-index: 1;
}

.carousel-page {
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  opacity:0;
  pointer-events:none;
  transition: opacity 3.8s ease;
}

.carousel-page.active {
  opacity:1;
  pointer-events:auto;
}

/* 初回用 深いフェード */
.carousel-page.first-load {
  opacity:0;
  transition: opacity 6s ease;
}

.carousel-inner {
  display:flex;
  gap:10px;
}

.carousel-inner img {
  width:80vw;
  max-width:480px;
  border-radius:8px;
  -webkit-user-drag:none;
}

/* ===============================
   ドット
   =============================== */

.dots {
  position:absolute;
  bottom:20px;
  width:100%;
  text-align:center;
  opacity:0;
  transition: opacity 17.7s ease;
}

.dots.visible { opacity:1; }

.dot {
  display:inline-block;
  width:10px;
  height:10px;
  background:#555;
  margin:0 5px;
}

.dot.active { background:#fff; }

</style>
</head>
<body>

<!-- 背景 -->
<div class="background-normal"></div>
<div class="background-siren"></div>

<div class="carousel-wrapper">

  <div class="carousel-page">
    <div class="carousel-inner">
      <img src="image/queen.of.clubs.png">
      <img src="image/queen.of.clubs_mirror.png">
    </div>
  </div>

  <div class="carousel-page">
    <div class="carousel-inner">
      <img src="image/king.of.spades.png">
      <img src="image/king.of.spades_mirror.png">
    </div>
  </div>

  <div class="carousel-page">
    <div class="carousel-inner">
      <img src="image/jack.of.hearts.png">
      <img src="image/jack.of.hearts_mirror.png">
    </div>
  </div>

  <div class="carousel-page">
    <div class="carousel-inner">
      <img src="image/joker_a.png">
      <img src="image/joker_b.png">
    </div>
  </div>

  <div class="carousel-page">
    <div class="carousel-inner">
      <img src="image/zebra.png">
    </div>
  </div>

  <div class="dots">
    <span class="dot active"></span>
    <span class="dot"></span>
    <span class="dot"></span>
    <span class="dot"></span>
    <span class="dot"></span>
  </div>
</div>

<script>
const pages = document.querySelectorAll(".carousel-page");
const dots = document.querySelectorAll(".dot");
const dotsContainer = document.querySelector(".dots");
const sirenBg = document.querySelector(".background-siren");

let currentPage = 0;
let isAnimating = true;

/* ===== 初回演出 ===== */
window.addEventListener("load", () => {
  const firstPage = pages[0];
  firstPage.classList.add("first-load", "active");

  // サイレンを 3.5秒流す
  setTimeout(() => {
    // サイレンをフェードアウト
    sirenBg.style.transition = "opacity 2s ease";
    sirenBg.style.opacity = 0;

    // カルーセルの深いフェード開始
    firstPage.style.opacity = 1;

    // フェード完了後
    setTimeout(() => {
      isAnimating = false;
      dotsContainer.classList.add("visible");
    }, 6000);

  }, 3500);
});

/* ===== ドット更新 ===== */
function updateDots() {
  dots.forEach((d,i)=>d.classList.toggle("active", i===currentPage));
}
</script>

</body>
</html>