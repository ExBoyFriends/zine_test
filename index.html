<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ZINE Image Viewer</title>

<style>
body {
  margin: 0;
  background: #000;
  overflow: hidden;
}

#viewer {
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
  touch-action: none;
}

/* 大きな一枚絵 */
#image {
  position: absolute;
  top: 50%;
  left: 0;
  transform: translate(0, -50%);
  user-select: none;
  -webkit-user-drag: none;
  will-change: transform;
}

/* 横向きのときは全体が必ず収まる */
.landscape #image {
  position: relative;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  max-width: 100%;
  max-height: 100%;
}
</style>
</head>

<body>

<div id="viewer">
  <!-- ここを自分の作品画像に差し替えて -->
  <img id="image" src="https://picsum.photos/2000/1200">
</div>

<script>
const viewer = document.getElementById("viewer");
const img = document.getElementById("image");

let startX = 0;
let currentX = 0;
let offsetX = 0;   // 今の画像位置（固定される）
let dragging = false;

function isPortrait() {
  return window.innerHeight > window.innerWidth;
}

function updateLayout() {
  if (isPortrait()) {
    document.body.classList.remove("landscape");

    // 縦型では画像は「実寸」で置く
    img.style.maxWidth = "none";
    img.style.maxHeight = "none";

    // 初期状態：左半分が画面に来る
    // = 左端をぴったり合わせる
    if (offsetX === null) offsetX = 0;
    applyTransform(offsetX);

  } else {
    document.body.classList.add("landscape");

    // 横型は全体をフィット表示
    offsetX = 0;
    img.style.transform = "";
  }
}

function applyTransform(x) {
  img.style.transform = `translate(${x}px, -50%)`;
}

// 画像サイズと画面サイズからドラッグ範囲を計算
function clampOffset(x) {
  const imgWidth = img.naturalWidth;
  const viewWidth = viewer.clientWidth;

  // 左端ストッパー：0
  const maxX = 0;
  // 右端ストッパー：画像の右端まで見える位置
  const minX = viewWidth - imgWidth;

  return Math.max(minX, Math.min(maxX, x));
}

/* 向き変更対応 */
window.addEventListener("resize", updateLayout);
img.onload = () => {
  offsetX = 0;
  updateLayout();
};

/* ===== タッチ操作（縦型のみ有効）===== */

viewer.addEventListener("touchstart", e => {
  if (!isPortrait()) return;
  dragging = true;
  startX = e.touches[0].clientX;
  currentX = startX;
});

viewer.addEventListener("touchmove", e => {
  if (!dragging || !isPortrait()) return;
  e.preventDefault();

  currentX = e.touches[0].clientX;
  const dx = currentX - startX;
  const nextX = clampOffset(offsetX + dx);

  applyTransform(nextX);
});

viewer.addEventListener("touchend", () => {
  if (!isPortrait()) return;
  dragging = false;

  // 今の位置をそのまま固定する（戻らない）
  const transform = img.style.transform;
  const match = /translate\(([-0-9.]+)px/.exec(transform);
  if (match) {
    offsetX = parseFloat(match[1]);
  }
});
</script>

</body>
</html>