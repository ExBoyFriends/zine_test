
/* loader.css */


/* ローダー全体のコンテナ */
#loader {
  position: fixed;
  inset: 0;
  z-index: 10000;
  background: #000;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  /* 夜明けのフェードアウト設定 */
  transition: opacity 2.8s cubic-bezier(0.2, 1, 0.2, 1);
  will-change: opacity;
}

/* 背景画像（ローディング中に表示される画像） */
.loader-bg-image {
  position: absolute;
  inset: 0;
  width: 100vw;
  height: 100vh;
  background: url('../../image/background.jpg') center / cover no-repeat;
  z-index: 10000;
  /* GPU描画を促し、カクつきを抑える */
  transform: translateZ(0);
}

/* 鼓動し、画面を飲み込む楕円の影 */
#fadeLayer {
  position: absolute;
  inset: -100%; 
  z-index: 10002;
  /* 右下(85% 105%)を起点とした黒い楕円グラデーション */
  background: radial-gradient(ellipse at 85% 105%, 
    rgba(0, 0, 0, 1.0) 0%, 
    rgba(0, 0, 0, 0.8) 25%, 
    rgba(0, 0, 0, 0.3) 70%, 
    rgba(0, 0, 0, 0) 96%);
  mix-blend-mode: multiply;
  filter: blur(80px);
  will-change: transform, opacity;
  /* 初期状態：鼓動アニメーション */
  transform: scale(2.2) translateZ(0);
  animation: fastLooming 1.0s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
}

/* 鼓動のアニメーション定義 */
@keyframes fastLooming {
  0% { 
    opacity: 0; 
    transform: scale(2.2) translateZ(0); 
  }
  100% { 
    opacity: 1.0; 
    transform: scale(1.0) translateZ(0); 
  }
}

/* --- 終了フェーズ1：暗転（右下から中央へ） --- */
#loader.swallow-darkness #fadeLayer {
  /* 鼓動計算を止めて負荷を減らす */
  animation: none !important;
  /* 1.0sで中央(0,0)へ。鼓動のリズムに合わせた鋭い動き */
  transition: transform 1.0s cubic-bezier(0.2, 1, 0.2, 1);
  transform: scale(5.0) translate(0, 0) translateZ(0); 
  opacity: 1;
}

/* 暗転用の黒幕（影の隙間を埋め、完全な漆黒を作る） */
#loader.swallow-darkness::after {
  content: "";
  position: absolute;
  inset: -10%;
  background: #000;
  z-index: 10001;
  opacity: 0;
  pointer-events: none;
  animation: finalBlackout 1.0s forwards;
}

@keyframes finalBlackout {
  0%   { opacity: 0; }
  100% { opacity: 1; }
}

/* --- 終了フェーズ2：夜明け（右下へ引き返す） --- */
/* 中央に居座った闇が、再び右下方向へ抜けていく */
#loader.reveal-start #fadeLayer {
  /* 2.8s：出だしは速く、後半は極めてゆっくり減速して消える */
  transition: transform 2.8s cubic-bezier(0.2, 1, 0.2, 1), 
              opacity 2.8s ease-in-out;
  /* 右下方向(50%, 50%)へ移動しながらフェードアウト */
  transform: scale(5.0) translate(50%, 50%) translateZ(0);
  opacity: 0;
}

/* 画像と黒幕も同期して消去 */
#loader.reveal-start .loader-bg-image,
#loader.reveal-start::after {
  transition: opacity 2.8s ease-in-out;
  opacity: 0;
}
