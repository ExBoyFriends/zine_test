
/* loader.css */


/* ローダー全体のコンテナ */
#loader {
  position: fixed;
  inset: 0;
  z-index: 10000;
  background: #000;
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
  /* 夜明けのフェードアウト設定 */
  transition: opacity 2.8s cubic-bezier(0.2, 1, 0.2, 1);
  will-change: opacity;
}

/* 背景画像（ローディング中に表示される画像） */
.loader-bg-image {
  position: absolute;
  inset: 0;
  width: 100vw;
  height: 100vh;
  background: url('../../image/background.jpg') center / cover no-repeat;
  z-index: 10000;
  /* GPU描画を促し、カクつきを抑える */
  transform: translateZ(0);
}

/* 鼓動し、画面を飲み込む楕円の影 */
#fadeLayer {
  position: absolute;
  inset: -100%; 
  z-index: 10002;
  /* 右下(85% 105%)を起点とした黒い楕円グラデーション */
  background: radial-gradient(ellipse at 85% 105%, 
    rgba(0, 0, 0, 1.0) 0%, 
    rgba(0, 0, 0, 0.8) 25%, 
    rgba(0, 0, 0, 0.3) 70%, 
    rgba(0, 0, 0, 0) 96%);
  mix-blend-mode: multiply;
  filter: blur(80px);
  will-change: transform, opacity;
  /* 初期状態：鼓動アニメーション */
  transform: scale(2.2) translateZ(0);
  animation: fastLooming 1.0s cubic-bezier(0.4, 0, 0.2, 1) infinite alternate;
}

/* 鼓動のアニメーション定義 */
@keyframes fastLooming {
  0% { 
    opacity: 0; 
    transform: scale(2.2) translateZ(0); 
  }
  100% { 
    opacity: 1.0; 
    transform: scale(1.0) translateZ(0); 
  }
}

/* --- 前半は維持 --- */

/* 終了フェーズ1：暗転 */
#loader.swallow-darkness #fadeLayer {
  animation: none !important;
  transition: transform 1.0s cubic-bezier(0.2, 1, 0.2, 1);
  /* scaleは3.0程度で十分画面を覆えます。大きくしすぎないのがコツ */
  transform: scale(3.0) translate(0, 0) translateZ(0); 
  opacity: 1;
}

/* ★重要：影の隙間を埋める黒幕。inset: -100%にして画面外の隙間を消す */
#loader.swallow-darkness::after {
  content: "";
  position: absolute;
  inset: -100%; /* 大きく広げて「左側の黒いもの」を完全に隠す */
  background: #000;
  z-index: 10001;
  opacity: 0;
  pointer-events: none;
  animation: finalBlackout 1.0s forwards;
}

@keyframes finalBlackout {
  0% { opacity: 0; }
  100% { opacity: 1; }
}

/* --- 終了フェーズ2：夜明け（引き波） --- */
#loader.reveal-start #fadeLayer {
  /* 移動を translate(30%, 30%) 程度に抑え、左側のハミ出しを防ぐ */
  transition: transform 2.8s cubic-bezier(0.2, 1, 0.2, 1), 
              opacity 2.8s ease-in-out;
  transform: scale(3.0) translate(30%, 30%) translateZ(0);
  opacity: 0;
}

/* 画像と黒幕も同期。ここで全てが消える */
#loader.reveal-start .loader-bg-image,
#loader.reveal-start::after {
  transition: opacity 2.8s ease-in-out;
  opacity: 0;
}
